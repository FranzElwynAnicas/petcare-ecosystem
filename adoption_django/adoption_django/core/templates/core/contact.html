{% extends "core/base.html" %}
{% block title %}Contact Us - Pawsitive Manila{% endblock %}

{% block content %}
<div class="container py-5">
  <!-- Header Section -->
  <div class="row mb-5">
    <div class="col-lg-8 mx-auto text-center">
      <h1 class="display-4 fw-bold mb-3 text-primary">Get In Touch</h1>
      <p class="lead">We'd love to hear from you! Whether you have questions about adoption, want to volunteer, or need support, our team is here to help.</p>
    </div>
  </div>

  <div class="row">
    <!-- Contact Form -->
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-primary text-white py-3">
          <h4 class="mb-0"><i class="bi bi-envelope-paper me-2"></i>Send Us a Message</h4>
        </div>
        <div class="card-body p-4">
          <!-- Display Django messages -->
          {% if messages %}
          <div class="mb-4">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
              <i class="bi bi-check-circle-fill me-2"></i>
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
          </div>
          {% endif %}

          <form method="POST" action="{% url 'contact' %}" id="contactForm" novalidate>
            {% csrf_token %}
            
            <!-- Display form errors -->
            {% if form.errors %}
            <div class="alert alert-danger">
              <strong>Please correct the errors below:</strong>
              <ul class="mb-0">
                {% for field in form %}
                  {% for error in field.errors %}
                    <li>{{ field.label }}: {{ error }}</li>
                  {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                  <li>{{ error }}</li>
                {% endfor %}
              </ul>
            </div>
            {% endif %}

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="id_first_name" class="form-label">First Name *</label>
                <input type="text" class="form-control" id="id_first_name" name="first_name" 
                       value="{{ form.first_name.value|default:'' }}" required>
                <div class="invalid-feedback">Please provide your first name.</div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="id_last_name" class="form-label">Last Name *</label>
                <input type="text" class="form-control" id="id_last_name" name="last_name" 
                       value="{{ form.last_name.value|default:'' }}" required>
                <div class="invalid-feedback">Please provide your last name.</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="id_email" class="form-label">Email Address *</label>
              <input type="email" class="form-control" id="id_email" name="email" 
                     value="{{ form.email.value|default:'' }}" required>
              <div class="invalid-feedback">Please provide a valid email address.</div>
            </div>

            <div class="mb-3">
              <label for="id_phone" class="form-label">Phone Number</label>
              <input type="tel" class="form-control" id="id_phone" name="phone" 
                     value="{{ form.phone.value|default:'' }}" placeholder="+63 900 123 4567">
            </div>

            <div class="mb-3">
              <label for="id_subject" class="form-label">Subject *</label>
              <select class="form-select" id="id_subject" name="subject" required>
                <option value="" selected disabled>Select a topic...</option>
                <option value="adoption" {% if form.subject.value == 'adoption' %}selected{% endif %}>Adoption Inquiry</option>
                <option value="volunteer" {% if form.subject.value == 'volunteer' %}selected{% endif %}>Volunteer Opportunity</option>
                <option value="donation" {% if form.subject.value == 'donation' %}selected{% endif %}>Donation Question</option>
                <option value="support" {% if form.subject.value == 'support' %}selected{% endif %}>Technical Support</option>
                <option value="partnership" {% if form.subject.value == 'partnership' %}selected{% endif %}>Partnership</option>
                <option value="other" {% if form.subject.value == 'other' %}selected{% endif %}>Other</option>
              </select>
              <div class="invalid-feedback">Please select a subject.</div>
            </div>

            <div class="mb-3">
              <label for="id_message" class="form-label">Message *</label>
              <textarea class="form-control" id="id_message" name="message" rows="5" 
                        placeholder="Tell us how we can help you..." required>{{ form.message.value|default:'' }}</textarea>
              <div class="invalid-feedback">Please enter your message.</div>
              <div class="form-text">Maximum 500 characters</div>
            </div>

            <div class="mb-3 form-check">
              <input type="checkbox" class="form-check-input" id="id_newsletter_subscription" name="newsletter_subscription"
                     {% if form.newsletter_subscription.value %}checked{% endif %}>
              <label class="form-check-label" for="id_newsletter_subscription">
                Subscribe to our newsletter for updates on available pets and events
              </label>
            </div>

            <button type="submit" class="btn btn-primary btn-lg w-100 py-2">
              <i class="bi bi-send me-2"></i> Send Message
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Contact Information -->
    <div class="col-lg-4 mt-4 mt-lg-0">
      <!-- Contact Cards -->
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body text-center p-4">
          <div class="icon-container bg-primary bg-opacity-10 mb-3 mx-auto">
            <i class="bi bi-geo-alt-fill text-primary fs-2"></i>
          </div>
          <h5>Visit Our Office</h5>
          <p class="text-muted mb-0">123 Pet Adoption Center<br>Manila, Philippines 1000</p>
        </div>
      </div>

      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body text-center p-4">
          <div class="icon-container bg-success bg-opacity-10 mb-3 mx-auto">
            <i class="bi bi-telephone-fill text-success fs-2"></i>
          </div>
          <h5>Call Us</h5>
          <p class="text-muted mb-2">+63 2 8123 4567</p>
          <p class="text-muted mb-0">+63 900 123 4567</p>
          <small class="text-muted">Mon-Fri, 9:00 AM - 6:00 PM</small>
        </div>
      </div>

      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body text-center p-4">
          <div class="icon-container bg-info bg-opacity-10 mb-3 mx-auto">
            <i class="bi bi-envelope-fill text-info fs-2"></i>
          </div>
          <h5>Email Us</h5>
          <p class="text-muted mb-1">support@pawsitivemanila.com</p>
          <p class="text-muted mb-0">adoptions@pawsitivemanila.com</p>
        </div>
      </div>

      <!-- Quick Links -->
      <div class="card border-0 shadow-sm">
        <div class="card-body p-3">
          <div class="d-grid gap-2">
            <a href="{% url 'pet_list' %}" class="btn btn-outline-primary btn-sm">
              <i class="bi bi-search me-1"></i> Browse Available Pets
            </a>
            <a href="#" class="btn btn-outline-success btn-sm">
              <i class="bi bi-heart me-1"></i> Volunteer Application
            </a>
            <a href="#" class="btn btn-outline-info btn-sm">
              <i class="bi bi-question-circle me-1"></i> FAQ & Support
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Map Section -->
  <div class="row mt-5">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-light py-3">
          <h5 class="mb-0"><i class="bi bi-map me-2"></i>Find Our Location</h5>
        </div>
        <div class="card-body p-0">
          <div class="map-container">
            <iframe 
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3861.927234012447!2d120.98445597599876!3d14.55448577724961!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3397c90264a0ed01%3A0x2b066ed57830cace!2sManila%2C%20Metro%20Manila!5e0!3m2!1sen!2sph!4v1698765432100!5m2!1sen!2sph"
              width="100%" 
              height="400" 
              style="border:0;" 
              allowfullscreen="" 
              loading="lazy" 
              referrerpolicy="no-referrer-when-downgrade">
            </iframe>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- FAQ Section -->
  <div class="row mt-5">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-primary text-white py-3">
          <h5 class="mb-0"><i class="bi bi-question-circle me-2"></i>Frequently Asked Questions</h5>
        </div>
        <div class="card-body">
          <div class="accordion" id="faqAccordion">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                  How long does the adoption process take?
                </button>
              </h2>
              <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  The adoption process typically takes 3-7 days from application to approval. This includes application review, reference checks, and the meet-and-greet session.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                  What are the adoption requirements?
                </button>
              </h2>
              <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  You must be at least 18 years old, have a valid ID, provide proof of address, and demonstrate the ability to care for a pet. We also conduct home visits for certain cases.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                  Can I volunteer at your shelter?
                </button>
              </h2>
              <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  Absolutely! We welcome volunteers. You can help with animal care, administrative tasks, or events. Fill out our volunteer application form to get started.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.icon-container {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.map-container {
  position: relative;
  overflow: hidden;
  border-radius: 0 0 0.375rem 0.375rem;
}

.card {
  transition: transform 0.2s ease-in-out;
}

.card:hover {
  transform: translateY(-2px);
}

.accordion-button:not(.collapsed) {
  background-color: rgba(13, 110, 253, 0.1);
  color: #0d6efd;
}

.form-control:focus, .form-select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}

.btn-primary {
  background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%);
  border: none;
  transition: all 0.3s ease;
}

.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Character counter for message
  const message = document.getElementById('id_message');
  if (message) {
    message.addEventListener('input', function() {
      const maxLength = 500;
      const currentLength = this.value.length;
      const counter = this.nextElementSibling.nextElementSibling;
      
      if (currentLength > maxLength) {
        this.value = this.value.substring(0, maxLength);
        counter.textContent = 'Maximum 500 characters (reached)';
        counter.className = 'form-text text-danger';
      } else {
        counter.textContent = `${maxLength - currentLength} characters remaining`;
        counter.className = 'form-text text-muted';
      }
    });
  }

  // Add animation to cards on scroll
  const cards = document.querySelectorAll('.card');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, { threshold: 0.1 });

  cards.forEach(card => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(20px)';
    card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
    observer.observe(card);
  });
});
</script>
{% endblock %}